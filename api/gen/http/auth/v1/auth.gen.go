// Package authv1http provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.5.1 DO NOT EDIT.
package authv1http

// CheckRequest Original request metadata forwarded by EdgeQuota.
type CheckRequest struct {
	// Body Optional base64-encoded request body, included when
	// propagate_request_body is enabled. Capped to max_auth_body_size
	// (default 64 KiB).
	Body *[]byte `json:"body,omitempty"`

	// Headers Flattened request headers (first value per key).
	Headers map[string]string `json:"headers"`

	// Method HTTP method (GET, POST, etc.).
	Method string `json:"method"`

	// Path Request path (e.g. /api/v1/resource).
	Path string `json:"path"`

	// RemoteAddr Client remote address (ip:port).
	RemoteAddr string `json:"remote_addr"`
}

// CheckResponse Auth decision returned to EdgeQuota.
type CheckResponse struct {
	// Allowed Whether the request is allowed to proceed.
	Allowed bool `json:"allowed"`

	// CacheMaxAgeSeconds Cache duration in seconds. When present and > 0, overrides the default
	// cache TTL. A value of 0 is treated as "not set". Set this to the
	// remaining token TTL so EdgeQuota skips redundant auth calls for the
	// same credential until the token expires.
	CacheMaxAgeSeconds *int64 `json:"cache_max_age_seconds,omitempty"`

	// CacheNoStore If true, the response must not be cached.
	CacheNoStore *bool `json:"cache_no_store,omitempty"`

	// DenyBody Response body to send when denied.
	DenyBody *string `json:"deny_body,omitempty"`

	// RequestHeaders Headers to inject into the upstream request when allowed.
	// Use this to pass auth-derived metadata (e.g. tenant ID, plan tier)
	// to downstream stages such as rate limiting and the backend.
	RequestHeaders *map[string]string `json:"request_headers,omitempty"`

	// ResponseHeaders Additional headers to set on the deny response.
	ResponseHeaders *map[string]string `json:"response_headers,omitempty"`

	// StatusCode HTTP status code to return when denied (e.g. 401, 403).
	StatusCode int32 `json:"status_code"`
}

// CheckJSONRequestBody defines body for Check for application/json ContentType.
type CheckJSONRequestBody = CheckRequest
